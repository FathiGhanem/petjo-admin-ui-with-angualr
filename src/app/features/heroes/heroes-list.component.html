<p-toast />
<p-confirmDialog />

<div class="page-container">
  <div class="page-header">
    <div>
      <h1>Hero Section</h1>
      <p class="subtitle">Manage homepage hero banner items</p>
    </div>
    <div class="page-actions">
      <p-button label="Add Hero" icon="pi pi-plus" severity="primary"
                (onClick)="openCreateDialog()" />
    </div>
  </div>

  <!-- Hero Grid -->
  @if (loading()) {
    <div class="heroes-grid">
      @for (i of [1,2,3]; track i) {
        <div class="hero-card skeleton-card">
          <div class="skeleton-img"></div>
          <div class="skeleton-text"></div>
        </div>
      }
    </div>
  } @else if (heroes().length === 0) {
    <p-card>
      <div class="empty-state">
        <i class="pi pi-star"></i>
        <h3>No hero items</h3>
        <p>Create hero banners for the homepage</p>
        <p-button label="Add First Hero" icon="pi pi-plus" severity="primary"
                  (onClick)="openCreateDialog()" [style]="{ 'margin-top': '1rem' }" />
      </div>
    </p-card>
  } @else {
    <div class="heroes-grid">
      @for (hero of heroes(); track hero.id) {
        <div class="hero-card">
          <div class="hero-image">
            @if (hero.img_path) {
              <img [src]="hero.img_path" [alt]="'Hero ' + hero.id" />
            } @else {
              <div class="no-image-placeholder">
                <i class="pi pi-image"></i>
                <span>No image</span>
              </div>
            }
            <div class="hero-overlay">
              <button pButton icon="pi pi-pencil" severity="info"
                      [rounded]="true" size="small"
                      pTooltip="Edit" tooltipPosition="top"
                      (click)="openEditDialog(hero)"></button>
              <button pButton icon="pi pi-trash" severity="danger"
                      [rounded]="true" size="small"
                      pTooltip="Delete" tooltipPosition="top"
                      (click)="confirmDelete(hero)"></button>
            </div>
          </div>
          <div class="hero-info">
            <div class="hero-meta">
              <span class="hero-id">#{{ hero.id }}</span>
              <span class="hero-date">{{ hero.created_at | date:'mediumDate' }}</span>
            </div>
            @if (hero.link) {
              <a [href]="hero.link" target="_blank" rel="noopener" class="hero-link">
                <i class="pi pi-external-link"></i>
                {{ hero.link | slice:0:40 }}{{ hero.link.length > 40 ? '...' : '' }}
              </a>
            } @else {
              <span class="no-link">No link</span>
            }
          </div>
        </div>
      }
    </div>
  }
</div>

<!-- Create/Edit Dialog -->
<p-dialog [header]="editingHero() ? 'Edit Hero' : 'New Hero'"
          [(visible)]="dialogVisible" [modal]="true" [style]="{ width: '500px' }">
  <div class="form-field">
    <label>Image Path / URL *</label>
    <input pInputText [(ngModel)]="formImgPath" placeholder="https://... or /assets/hero.jpg"
           class="w-full" />
  </div>
  <div class="form-field">
    <label>Link (optional)</label>
    <input pInputText [(ngModel)]="formLink" placeholder="https://..."
           class="w-full" />
  </div>
  @if (formImgPath) {
    <div class="dialog-preview">
      <label>Preview</label>
      <img [src]="formImgPath" alt="Preview" />
    </div>
  }
  <ng-template pTemplate="footer">
    <p-button label="Cancel" severity="secondary" [text]="true"
              (onClick)="dialogVisible = false" />
    <p-button [label]="editingHero() ? 'Update' : 'Create'" icon="pi pi-check"
              severity="primary" [disabled]="!formImgPath.trim()"
              (onClick)="save()" />
  </ng-template>
</p-dialog>
